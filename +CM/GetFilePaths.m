%% Create MSessionExplore filepaths for all mice
% MouseNames = {'EF0147' 'EF0148' 'EF0149' 'EF0150' 'EF0151' 'JL005' 'YT027' 'YT080' 'YT081'...
%     'YT043' 'YT044' 'YT059' 'YT071' 'YT083' 'YT084' 'YT085' 'YT086'...
%     'EF0076' 'EF0081' 'EF0084' 'EF0114'};
% SiProbe
MouseNames = {'EF0147' 'EF0148' 'EF0149' 'EF0150' 'EF0151' 'JL005' 'YT080' 'YT081' 'YT071'...
    'YT083' 'YT084' 'YT085' 'YT086'};

MouseNames_E = {'EF0147' 'EF0148' 'EF0149' 'EF0150' 'EF0151' 'JL005' 'YT027' 'YT080' 'YT081'};
% MouseNames_D = {'YT043' 'YT044' 'YT059'};
%MouseNames_F = {'EF0076' 'EF0081' 'EF0084' 'EF0114'};
MouseNames_F = {'YT071' 'YT083' 'YT084' 'YT085' 'YT086'};

for m = 1: length(MouseNames)
    MouseName = MouseNames{m};
    if ismember(MouseName,MouseNames_E)
        seDir = ['E:\', MouseName, '\MSessionExplorer_Ephy'];
    elseif ismember(MouseName,MouseNames_F)
        seDir = ['F:\', MouseName, '\MSessionExplorer_Ephy'];
    elseif ismember(MouseName,MouseNames_D)
        seDir = ['D:\', MouseName, '\MSessionExplorer_Ephy'];
    end
    cd(seDir)
    seFileLists = struct2cell(dir('*se*'));
    seFileNames = seFileLists(1,:);
    seFilePaths = cellfun(@(x) fullfile(seDir, x),seFileNames,'UniformOutput',false);
%     seFilePaths = MBrowse.Files(seDir);
    seFilePaths_all{m,1} = MouseName;
    seFilePaths_all{m,2} = seDir;
    seFilePaths_all{m,3} = seFilePaths;
end
% Convert to a table
VarNames = {'MouseName' 'seDir' 'seFilePaths'};
seFilePaths_all = cell2table(seFilePaths_all,'VariableNames', VarNames);

% Save paths
save('E:\seFilePaths_SiProbe', 'seFilePaths_all');

%%
% MouseNames = {'YT071','YT080','YT081','YT083','YT084','YT085','YT086',...
%     'JL005','EF0147','EF0148','EF0149','EF0150','EF0151'};
% MainDirs = {'D:\','E:\','E:\','F:\', 'F:\','F:\','F:\',...
%     'E:\','E:\','E:\','E:\','E:\','E:\'};
% seshDates = {{'190716', '190717', '190718', '190719', '190721', '190722', '190723', '190725', '190726',...
%     '190729', '190731', '190803', '190804', '190805'},...
%     {'190826', '190827', '190828', '190829', '190905', '190911', '190912'},...
%     {'190826', '190827', '190828', '190829', '190906', '190907', '190908', '190909', '190910', '190911'},...
%     {'200123', '200126', '200131', '200203', '200207', '200210', '200212'},...
%     {'200124', '200127', '200129', '200130', '200201', '200202', '200203', '200204', '200206', '200207',...
%     '200209', '200210', '200211'},...
%     {'200308', '200309', '200310', '200311', '200312', '200313', '200315', '200316', '200317','200320',...
%     '200321', '200322'},...
%     {'200308', '200311', '200313', '200314', '200316', '200317', '200318', '200319', '200320'},...
%     {'190716', '190717', '190719', '190721', '190722', '190723', '190724', '190726', '190728','190729',...
%     '190730', '190731', '190803', '190805', '190806', '190807'},...
%     {'190123', '190126', '190127', '190202', '190204', '190205', '190206', '190208', '190209', '190210'},...
%     {'190221', '190222', '190227', '190228', '190301', '190304', '190305', '190306', '190307', '190310',...
%     '190311', '190312', '190313', '190314'},...
%     {'190127', '190128', '190202', '190203', '190204', '190207', '190208', '190210', '190211', '190212',...
%     '190213', '190214'},...
%     {'190222', '190223', '190224', '190225', '190226', '190302', '190305', '190307', '190311', '190315',...
%     '190316', '190317', '190318'},...
%     {'190430', '190501a', '190502', '190503', '190504','190505', '190506', '190508', '190509',...
%     '190510','190511', '190512', '190513', '190514'}};
% 
% filePaths = table(MouseNames,MainDirs,seshDates, 'VariableNames', {'MouseName', 'MainDir', 'seshDate'});
% save('E:\filePaths','filePaths')